{% extends 'base.html' %}

{% block title %}Account{% endblock %}

{% block content %}
<div class="main-content">
    <div class="account container mt-2">
        <h1 class="text-center">{{user.username}}'s Account</h1>
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{message.tags}}" role="alert">
            {{ message }}
            </div>
            {% endfor %}
        {% endif %}
        <div class="row">
            <div class="col-md-6">
                <h2 class="text-center">Your account details</h2>
                <p>Here you can see and change the info we have on file for you.</p>
                <table class="w-100">
                    <caption>
                        Click on the pen icon to edit your info.
                        <a href="{% url 'edit_account' %}"><i class="fas fa-pen"></i></a>
                    </caption>
                    <tr>
                        <td>Username:</td>
                        <td>{{ user.username }}</td>
                    </tr>
                    <tr>
                        <td>Email Address:</td>
                        <td>{{ user.email }}</td>
                    </tr>
                    <tr>
                        <td>Name:</td>
                        <td>{{ user.first_name }} {{ user.last_name }}</td>
                    </tr>
                    <tr>
                        <td>Street Address:</td>
                        <td>{{ user.userinfo.street_address1 }}</td>
                    </tr>
                    <tr>
                        <td>Street Address line 2:</td>
                        <td>{{ user.userinfo.street_address2 }}</td>
                    </tr>
                    <tr>
                        <td>Town/City:</td>
                        <td>{{ user.userinfo.town_or_city }}</td>
                    </tr>
                    <tr>
                        <td>Postcode:</td>
                        <td>{{ user.userinfo.postcode }}</td>
                    </tr>
                    <tr>
                        <td>County:</td>
                        <td>{{ user.userinfo.county }}</td>
                    </tr>
                    <tr>
                        <td>Country:</td>
                        <td>{{ user.userinfo.country }}</td>
                    </tr>
                    <tr>
                        <td>Phone Number:</td>
                        <td>{{ user.userinfo.phone_number}}</td>
                    </tr>
                </table>
            </div>
            <div class="col-md-6">
                <h2 class="text-center">Previous orders</h2>
                <div>
                    <ol>
                    {% for order in orders %}
                        <li>{{ order.order.date }} - Subtotal: €{{order.total}}
                            <ul>
                                {% for item in order.items %}
                                <li>{{ item.item.subscription.frequency }} - {{ item.item.subscription.product.category }} - {{ item.item.quantity }} - Total: €{{ item.item_total }}</li>
                                {% endfor %}
                            </ul>
                        </li>
                    {% empty %}
                        <li>You don't have any orders yet</li>
                    {% endfor %}
                    </ol>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}